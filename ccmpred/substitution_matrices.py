import numpy as np


def matrianglify(data, size=20):
    """ Make a symmetric size * size matrix out of an array of triangle array data"""
    mat = np.zeros((size, size))
    for i in range(size):
        for j in range(size):
            ind=int(i*(i+1)//2+j)
            if (ind<len(data)):
                mat[i][j] = data[ind]
                mat[j][i] = data[ind]
    return mat


# BLOSUM62 matrix as P(a, b)
# from HH-suite hhmatrices.h @ https://github.com/soedinglab/hh-suite/blob/5015f267a051f9b7ebffcec04b7f0596ad01bbbd/src/hhmatrices.cpp
BLOSUM62 = matrianglify([
    #    A       R       N       D       C       Q       E       G       H       I       L       K       M       F       P       S       T       W       Y       V
    0.0215,
    0.0023, 0.0178,
    0.0019, 0.0020, 0.0141,
    0.0022, 0.0016, 0.0037, 0.0213,
    0.0016, 0.0004, 0.0004, 0.0004, 0.0119,
    0.0019, 0.0025, 0.0015, 0.0016, 0.0003, 0.0073,
    0.0030, 0.0027, 0.0022, 0.0049, 0.0004, 0.0035, 0.0161,
    0.0058, 0.0017, 0.0029, 0.0025, 0.0008, 0.0014, 0.0019, 0.0378,
    0.0011, 0.0012, 0.0014, 0.0010, 0.0002, 0.0010, 0.0014, 0.0010, 0.0093,
    0.0032, 0.0012, 0.0010, 0.0012, 0.0011, 0.0009, 0.0012, 0.0014, 0.0006, 0.0184,
    0.0044, 0.0024, 0.0014, 0.0015, 0.0016, 0.0016, 0.0020, 0.0021, 0.0010, 0.0114, 0.0371,
    0.0033, 0.0062, 0.0024, 0.0024, 0.0005, 0.0031, 0.0041, 0.0025, 0.0012, 0.0016, 0.0025, 0.0161,
    0.0013, 0.0008, 0.0005, 0.0005, 0.0004, 0.0007, 0.0007, 0.0007, 0.0004, 0.0025, 0.0049, 0.0009, 0.0040,
    0.0016, 0.0009, 0.0008, 0.0008, 0.0005, 0.0005, 0.0009, 0.0012, 0.0008, 0.0030, 0.0054, 0.0009, 0.0012, 0.0183,
    0.0022, 0.0010, 0.0009, 0.0012, 0.0004, 0.0008, 0.0014, 0.0014, 0.0005, 0.0010, 0.0014, 0.0016, 0.0004, 0.0005, 0.0191,
    0.0063, 0.0023, 0.0031, 0.0028, 0.0010, 0.0019, 0.0030, 0.0038, 0.0011, 0.0017, 0.0024, 0.0031, 0.0009, 0.0012, 0.0017, 0.0126,
    0.0037, 0.0018, 0.0022, 0.0019, 0.0009, 0.0014, 0.0020, 0.0022, 0.0007, 0.0027, 0.0033, 0.0023, 0.0010, 0.0012, 0.0014, 0.0047, 0.0125,
    0.0004, 0.0003, 0.0002, 0.0002, 0.0001, 0.0002, 0.0003, 0.0004, 0.0002, 0.0004, 0.0007, 0.0003, 0.0002, 0.0008, 0.0001, 0.0003, 0.0003, 0.0065,
    0.0013, 0.0009, 0.0007, 0.0006, 0.0003, 0.0007, 0.0009, 0.0008, 0.0015, 0.0014, 0.0022, 0.0010, 0.0006, 0.0042, 0.0005, 0.0010, 0.0009, 0.0009, 0.0102,
    0.0051, 0.0016, 0.0012, 0.0013, 0.0014, 0.0012, 0.0017, 0.0018, 0.0006, 0.0120, 0.0095, 0.0019, 0.0023, 0.0026, 0.0012, 0.0024, 0.0036, 0.0004, 0.0015, 0.0196
])
